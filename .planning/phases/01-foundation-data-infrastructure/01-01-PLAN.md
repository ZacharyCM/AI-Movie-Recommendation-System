---
phase: 01-foundation-data-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/next.config.ts
  - frontend/tailwind.config.ts
  - frontend/postcss.config.mjs
  - frontend/tsconfig.json
  - frontend/src/app/layout.tsx
  - frontend/src/app/page.tsx
  - frontend/src/app/globals.css
  - frontend/.env.local.example
  - frontend/.gitignore
  - frontend/src/lib/supabase/client.ts
  - frontend/src/lib/supabase/server.ts
  - frontend/src/lib/supabase/middleware.ts
autonomous: true
user_setup:
  - service: supabase
    why: "Authentication and PostgreSQL database for user data"
    env_vars:
      - name: NEXT_PUBLIC_SUPABASE_URL
        source: "Supabase Dashboard -> Project Settings -> API -> Project URL"
      - name: NEXT_PUBLIC_SUPABASE_ANON_KEY
        source: "Supabase Dashboard -> Project Settings -> API -> anon public key"
    dashboard_config:
      - task: "Create a new Supabase project"
        location: "https://supabase.com/dashboard -> New Project"
      - task: "Enable email/password auth provider"
        location: "Supabase Dashboard -> Authentication -> Providers -> Email"

must_haves:
  truths:
    - "Next.js frontend dev server starts without errors on port 3000"
    - "Supabase client can be imported and initialized in frontend code"
    - "Tailwind CSS classes render correctly in the browser"
  artifacts:
    - path: "frontend/package.json"
      provides: "Next.js project with dependencies"
      contains: "next"
    - path: "frontend/src/app/layout.tsx"
      provides: "Root layout with dark theme base"
      min_lines: 15
    - path: "frontend/src/lib/supabase/client.ts"
      provides: "Browser Supabase client"
      contains: "createBrowserClient"
    - path: "frontend/src/lib/supabase/server.ts"
      provides: "Server-side Supabase client"
      contains: "createServerClient"
    - path: "frontend/src/lib/supabase/middleware.ts"
      provides: "Supabase session middleware helper"
      contains: "updateSession"
  key_links:
    - from: "frontend/src/lib/supabase/client.ts"
      to: "Supabase project"
      via: "NEXT_PUBLIC_SUPABASE_URL env var"
      pattern: "NEXT_PUBLIC_SUPABASE_URL"
---

<objective>
Scaffold the Next.js frontend project with Tailwind CSS, dark theme base, and configure Supabase auth client utilities for browser, server, and middleware contexts.

Purpose: Establish the frontend project structure and Supabase integration that auth flows (Plan 03) and catalog UI (Plan 05) depend on. Nothing frontend-facing can be built until the Next.js project exists with Supabase clients ready.

Output: Runnable Next.js frontend (port 3000) with dark theme, installed dependencies, and configured Supabase client utilities.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Next.js frontend with Tailwind dark theme and install dependencies</name>
  <files>
    frontend/package.json
    frontend/next.config.ts
    frontend/tailwind.config.ts
    frontend/postcss.config.mjs
    frontend/tsconfig.json
    frontend/src/app/layout.tsx
    frontend/src/app/page.tsx
    frontend/src/app/globals.css
    frontend/.env.local.example
    frontend/.gitignore
  </files>
  <action>
    Create a `frontend/` directory at project root. Initialize a Next.js 14+ App Router project with TypeScript:
    - Run `npx create-next-app@latest frontend --typescript --tailwind --eslint --app --src-dir --import-alias "@/*" --no-git` from project root
    - After scaffolding, update `frontend/src/app/globals.css` to set dark mode base: body background `#0f172a` (slate-900), text `#e2e8f0` (slate-200)
    - Update `frontend/src/app/layout.tsx`: set metadata title "NetflixRecs", add `className="dark"` to html element, set body class to `bg-slate-900 text-slate-200 min-h-screen`
    - Update `frontend/src/app/page.tsx`: simple landing page with "NetflixRecs" heading and "Your AI-powered movie recommendation engine" subtitle, centered. This is a placeholder.
    - Create `frontend/.env.local.example` with placeholder vars: `NEXT_PUBLIC_SUPABASE_URL=your_supabase_url`, `NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key`, `NEXT_PUBLIC_API_URL=http://localhost:8000`
    - Install additional frontend deps: `npm install @supabase/ssr @supabase/supabase-js zustand @tanstack/react-query framer-motion`
    - Verify `npm run dev` starts successfully, then stop it
  </action>
  <verify>
    - `cd frontend && npm run dev` starts Next.js on port 3000 (stop after confirming)
    - Opening http://localhost:3000 shows the dark-themed NetflixRecs placeholder page
  </verify>
  <done>Next.js frontend starts on port 3000 with dark slate-900 theme, all dependencies installed, placeholder landing page visible.</done>
</task>

<task type="auto">
  <name>Task 2: Configure Supabase client utilities for browser, server, and middleware</name>
  <files>
    frontend/src/lib/supabase/client.ts
    frontend/src/lib/supabase/server.ts
    frontend/src/lib/supabase/middleware.ts
  </files>
  <action>
    Create Supabase client utilities for Next.js App Router (following Supabase SSR pattern with @supabase/ssr):

    `frontend/src/lib/supabase/client.ts`:
    - Export `createClient()` function that returns a browser Supabase client using `createBrowserClient` from `@supabase/ssr`
    - Uses `process.env.NEXT_PUBLIC_SUPABASE_URL!` and `process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!`

    `frontend/src/lib/supabase/server.ts`:
    - Export async `createClient()` function for Server Components / Route Handlers
    - Uses `createServerClient` from `@supabase/ssr` with cookie handling via `next/headers` cookies()
    - Implements `getAll` and `setAll` cookie methods per Supabase SSR docs

    `frontend/src/lib/supabase/middleware.ts`:
    - Export `updateSession(request: NextRequest)` function
    - Creates server client with request/response cookie bridging for session refresh
    - Returns the response with updated cookies
    - This will be used by the root middleware.ts in Plan 03
  </action>
  <verify>
    - `frontend/src/lib/supabase/client.ts` compiles without TypeScript errors: `cd frontend && npx tsc --noEmit`
    - All three Supabase client files are importable without errors
  </verify>
  <done>Supabase browser/server/middleware clients configured and importable. Ready for auth flows in Plan 03.</done>
</task>

</tasks>

<verification>
- `npm run dev` in frontend/ starts without errors
- TypeScript compilation passes: `cd frontend && npx tsc --noEmit`
- `.env.local.example` documents all required env vars
- Supabase client files import without errors
</verification>

<success_criteria>
1. Next.js frontend starts on port 3000 with dark slate theme
2. Supabase client utilities exist for browser, server, and middleware contexts
3. All dependencies installed (@supabase/ssr, @supabase/supabase-js, zustand, @tanstack/react-query, framer-motion)
4. Environment variable template documents Supabase configuration
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-data-infrastructure/01-01-SUMMARY.md`
</output>
